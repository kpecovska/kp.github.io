<!doctype html>
<html>
  <head>
    
    <!-- GTM Datalayer init -->
    <script>
    window.dataLayer = window.dataLayer || [];
    </script>
    
    <!-- Google Tag Manager -->
      <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-WRKRQ3R');</script>
    <!-- End Google Tag Manager -->
    
    <title>People WebSDK page with Google Tag Manager</title>
    
  </head>
  <body>
    
    <!-- Google Tag Manager (noscript) -->
      <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WRKRQ3R"
      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <h1>People WebSDK test site with Google Tag mngr.</h1>
    <hr>   
    
    <h2>Login form:</h2>
    <form class="login-form" id="login-form">
       <div>
        <label for="email">Provide your email: </label>
        <input type="text" name="email" id="email" required>
      </div>
      <div>
        <input type="submit" value="Log In">
      </div>
    </form>
    
    <hr>
    
    <h2>Profile update form:</h2>
    <form class="profile-form" id="profile-form">
      <div>
        <label for="property">Your first name: </label>
        <input type="text" name="property" id="first-name" required>
      </div>
      <div>
        <label for="lastName">Your Last name: </label>
        <input type="text" name="property" id="last-name" required>
      </div>
      <div>
        <input type="submit" value="Update Profile">
      </div>
    </form>
    
    <hr>
    
    <h2>Send event form (event = purchasealex):</h2>
     <form class="event-form" id="event-form">
       <div>
        <label for="product">Product Name: </label>
        <input type="text" name="product" id="product" required>
      </div>
       <div>
        <label for="product_qty">Quantity: </label>
        <input type="text" name="product" id="product_qty" required>
      </div>
      <div>
        <input type="submit" value="Send Event">
      </div>
    </form>
    
     <script>
      const onLoginFormSubmit = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.login-form'));
        const formEmail = formData.get('email');
        window.dataLayer.push({'person_email': formEmail, 'event': 'login'});
        console.log('Logged In');
      };
       
      const onSendClick = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.event-form'));
        const formProduct = formData.get('product');
        const formProductQty = formData.get('product-qty');
        window.dataLayer.push({'product_name': formProduct, 'event': 'send_event'}, {'product_qty': formProductQty, 'event': 'send_event'});
        console.log('Sent Event');
      };
       
       const onUpdateClick = (evt) => {
        evt.preventDefault();
        const formData = new FormData(document.querySelector('.profile-form'));
        const formProp1 = formData.get('first-name');
        const formProp2 = formData.get('last-name');
        window.dataLayer.push({'first_name': formProp1, 'event': 'update_profile'}, {'last_name': formProp2, 'event': 'update_profile'});
        console.log('Updated Profile');
      };

      const loginForm = document.querySelector('.login-form');
      loginForm.addEventListener('submit', onLoginFormSubmit);
      const profileForm = document.querySelector('.profile-form');
      profileForm.addEventListener('submit', onUpdateClick);
      const eventForm = document.querySelector('.event-form');
      eventForm.addEventListener('submit', onSendClick);
    </script>
    
   
  </body>
</html>
